0. 运行节点
rosrun formation_dec forRealCar.py
roslaunch simulation multi_car_simulation.launch

1. 多机通信
https://blog.csdn.net/hehedadaq/article/details/82898307
注意要点：
  - .bashrc中增加 ROS_HOSTNAME 和ROS_MASTER_URI。其中hostname为本机的昵称，叫啥都行。ROS_MASTER_URI为主机的地址
  - sudo gedit /etc/hosts 文件。添加hostname对应的ip地址。
  - 测试。使用自带的turlesim包中的turtlesim_node, turle_teleop_key分别在不同端，看看从机能否控制主机中的乌龟。

2. rosluanch修改添加ns
  如果用c++写话题，需要话题不用/开头，否则为global_name，ns不起作用。
3. 算法修改
队形不能距离障碍物太近，没有办法完成

4. 没有让他停到指定的位置。因为实时决策时，最多能够回到航线，不会回到
方法：分段目的地
改成lattice planner？

5. 实车调试问题：
 - 没有考虑好虚拟车。状态管理器卡着了。
 - 没有可视化程序。调试困难。

6. 地图测距
   - 70*10米
   - 

周四晚任务：
1. 完成单车循迹修改后的功能测试
2. 完成编队调试工作
3. 录制实车跑的视频，以及相应的ROS BAG包，方便回看，以及生成对应动图

本周进展：
周日：GPS信号不稳定，且代码有问题，调试失败；
周一：尝试重新标定GPS，下雨，只标定成功一辆车
周二：暂停
周三：

完成GPS的标定(done)
直线行驶测试(done：稍微有点歪，初始值不好时，画龙)
弯道行驶测试(没做，意义不大)
录制ROS BAG
完善画图程序(画图程序有bug， sub_gps_states报错missing 输入参数i) - 完成一版修改
ROSBAG问题分析(GNSS位置信息有时候无法更新)

周五：
改用大功率WiFi
能实现动态避障
可视化程序修改完成，并且进行更新
对编队的代码进行了进一步debug，发现并修正了坐标系遗留的问题

目前仍需修改问题：
1. 车辆运行'犹豫'，因为wifi不够稳定，有时候会突然Ping不通，或者延时很高。理论上，执行局部轨迹不应该需要这么高要求的通信
2. 车辆硬件差，轨迹跟踪算法也差， 不能较好的跟踪轨迹
3. 编队队形可调整性

需要任务：
实车
1. 编队测试
2. 仿真查看编队是否可行
3. 编队内核拆分 (？)
4. 编队内核需要统一使用规范化的numpy形式的输入输出 (暂不考虑! 不好修改。因为所有都是)
5. 编队内核增加功能：乱序摆放开始(任意位置开始编队，包括队形阶段不同: 部分完成)
6. 增加sample basis 功能。

周一：
1. 仿真单核跑到100%：是否需要改成多进程。多进程会快一些
2. 无障碍时采用不同的仿真参数



代码疑问
0.为啥没有全局锁。采用多一个变量进行判定是否仍然会有问题。
1. 通信中反复定义publisher是否存在问题

修改了车上东西：
1. 网线ip设定
2. bash多车环境


仿真问题：
1. 五次多项式换不了道：五次多项式过于平滑，车头附近的轨迹与车身平行。轨迹跟踪算法采用纯追踪时，预瞄点一般选在车头附近，导致无法换道：
   1. 解决方法：五次换四次；MPC(不一定靠谱。因为MPC也是选择前几个数，然后前几个数可能还是保持现在的0转角);轨迹规划修改曲线类型；更改预瞄点位置；(修改轨迹跟踪程序是否合适？应该是自底向上调整) ->修改成3次多项式
2. 3次多项式的原点为啥不从自车开始？发生在轨迹切换时候(由于队形切换不一导致的)
3. 


1. 通信逻辑？需要重新启动节点才能够得到轨迹？猜测原因是一开始轨迹规划程序没有启动，receive 一开始接收不到信息，无法过一段时间才能够得到信息（重新启动节点即可）
2. 发布轨迹中有太小的速度，导致不可行。已修改(同一使用TARGET_SPEED控制速度)
3. 遥控器需要和小车在一定距离内，否则小车不会动
4. 如果程序出错，会一直重复上一个时刻的控制量：逻辑危险(小车容易不受控制)；(增加程序正常运行变量)
5. 收到空的轨迹时，不能自动停车(增加空列表检测)
6. 碰撞检测没有写好。比较卡顿。需要区分车头啥的，写个移轴定理
7. 白色车跑的特别慢(是否是purepursuit算法不同？电量是否有问题)

任务列表
1. 后两个阶段的完成(前后打击、通过障碍)
2. 迁移到5辆车
3. 如何不卡顿(减少控制点，csp由单独的队形点控制)

目前问题：
1. 如何保证避撞(谁让)：添加通行次序
2. 语义任务能否自动转为实际过程？
3. 为什么会出现非常远的最近点？
4. gps_server收到并且打印消息后，不会发送话题？？？画图不显示车。重启一下gps_server节点
5. frenet坐标系转换成x,y坐标系，阶段转换时，存在问题。规划轨迹特别偏。


注意事项
1. 编辑编队队形点时，不要使用有重合的直线（如朝着某条边平移）。距离cost的匈牙利算法此时稳定性较差。


11.13 问题记录
1. 3号车前轮转向存在问题，不转弯。后轮转向。